# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ë–ê–ì–ê –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –ö–ê–¢–ï–ì–û–†–ò–ô ‚úÖ

**–î–∞—Ç–∞:** 05.08.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û  
**–¢–∏–ø:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥  

## üêõ –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´

–ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π" –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª–∏ –Ω–∞ –Ω–∞–∂–∞—Ç–∏—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥–ª–∏ –≤—ã–±–∏—Ä–∞—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω—è—Ç—å –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–Ω–æ–ø–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ
- –ì–∞–ª–æ—á–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è–ª–∏—Å—å/–∏—Å—á–µ–∑–∞–ª–∏
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è

## üîç –ü–†–ò–ß–ò–ù–ê –ë–ê–ì–ê

**–ö–æ–Ω—Ñ–ª–∏–∫—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ callback'–æ–≤:**

ConversationHandler –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–ª –≤—Å–µ callback'—ã —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º `^(category_|categories_done|back).*$`, –≤–∫–ª—é—á–∞—è —Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è.

```python
# –í main.py - ConversationHandler
SELECTING_CATEGORIES: [
    CallbackQueryHandler(
        profile_handler_instance.handle_categories_selection,
        pattern="^(category_|categories_done|back).*$"  # ‚Üê –°–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω
    )
]

# –í profile.py - –æ–±—ã—á–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫  
elif data.startswith("category_"):
    await self.handle_category_toggle(update, context)  # ‚Üê –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª—Å—è
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Callback'—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ø–∞–¥–∞–ª–∏ –≤ ConversationHandler –≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞.

## ‚úÖ –†–ï–®–ï–ù–ò–ï

–†–∞–∑–¥–µ–ª–∏–ª–∏ callback'—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è:

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ `categories_selection`
```python
def categories_selection(selected_categories: list = None, edit_mode: bool = False):
    # –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è: callback_data = "category_id"  
    # –î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: callback_data = "edit_category_id"
    callback_data = f"{'edit_category_' if edit_mode else 'category_'}{category['id']}"
    
    # –î–ª—è –∫–Ω–æ–ø–∫–∏ "–ì–æ—Ç–æ–≤–æ":
    done_callback = "edit_categories_done" if edit_mode else "categories_done"
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback'–æ–≤
```python
# –î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
elif data == "edit_categories_done":
    await self.handle_categories_edit_done(update, context)
elif data.startswith("edit_category_"):
    await self.handle_category_toggle(update, context)
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `edit_categories`
```python
await query.edit_message_text(
    text,
    reply_markup=Keyboards.categories_selection(profile.categories, edit_mode=True),
    parse_mode='HTML'
)
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `handle_category_toggle`
```python
category_id = query.data.replace("edit_category_", "")
# ...
await query.edit_message_reply_markup(
    reply_markup=Keyboards.categories_selection(selected_categories, edit_mode=True)
)
```

## üîß –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

1. **`bot/utils/keyboards.py`**
   - –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `edit_mode` –≤ `categories_selection`
   - –†–∞–∑–Ω—ã–µ callback'—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

2. **`bot/handlers/profile.py`**
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏: `edit_categories_done`, `edit_category_*`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `handle_category_toggle` –¥–ª—è –Ω–æ–≤—ã—Ö callback'–æ–≤
   - –û–±–Ω–æ–≤–ª–µ–Ω `edit_categories` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `edit_mode=True`

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚ùå –ö–Ω–æ–ø–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ —Ä–µ–∞–≥–∏—Ä—É—é—Ç
- ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –ö–Ω–æ–ø–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ì–∞–ª–æ—á–∫–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è/–∏—Å—á–µ–∑–∞—é—Ç –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
- ‚úÖ –ú–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª—å

## üìã CALLBACK'–´

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (ConversationHandler):
- `category_mm_premier`
- `category_faceit` 
- `category_tournaments`
- `category_looking_for_team`
- `categories_done`

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (–æ–±—ã—á–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫):
- `edit_category_mm_premier`
- `edit_category_faceit`
- `edit_category_tournaments` 
- `edit_category_looking_for_team`
- `edit_categories_done`

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

‚úÖ **–ë–ê–ì –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù!**

–¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç:
- –í—ã–±–∏—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
- –í–∏–¥–µ—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å (–≥–∞–ª–æ—á–∫–∏)
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

**Backward compatibility:** –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ.

---

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤** üõ†Ô∏è
